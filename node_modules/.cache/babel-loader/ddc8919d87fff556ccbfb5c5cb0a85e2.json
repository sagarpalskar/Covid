{"ast":null,"code":"export class Loader {\n  constructor(apiKey = null, options = {}) {\n    this.apiKey = apiKey;\n    this.options = options;\n\n    if (typeof window === 'undefined') {\n      throw new Error('google-maps is supported only in browser environment');\n    }\n  }\n\n  load() {\n    if (typeof this.api !== 'undefined') {\n      return Promise.resolve(this.api);\n    }\n\n    if (typeof this.loader !== 'undefined') {\n      return this.loader;\n    }\n\n    window[Loader.CALLBACK_NAME] = () => {\n      this.api = window['google'];\n\n      if (typeof this.resolve === 'undefined') {\n        throw new Error('Should not happen');\n      }\n\n      this.resolve(this.api);\n    };\n\n    window['gm_authFailure'] = () => {\n      if (typeof this.reject === 'undefined') {\n        throw new Error('Should not happen');\n      }\n\n      this.reject(new Error('google-maps: authentication error'));\n    };\n\n    return this.loader = new Promise((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n      const script = document.createElement('script');\n      script.src = this.createUrl();\n      script.async = true;\n\n      script.onerror = e => reject(e);\n\n      document.head.appendChild(script);\n    });\n  }\n\n  createUrl() {\n    const parameters = [`callback=${Loader.CALLBACK_NAME}`];\n\n    if (this.apiKey) {\n      parameters.push(`key=${this.apiKey}`);\n    }\n\n    for (let name in this.options) {\n      if (this.options.hasOwnProperty(name)) {\n        let value = this.options[name];\n\n        if (name === 'version') {\n          name = 'v';\n        }\n\n        if (name === 'libraries') {\n          value = value.join(',');\n        }\n\n        parameters.push(`${name}=${value}`);\n      }\n    }\n\n    return `https://maps.googleapis.com/maps/api/js?${parameters.join('&')}`;\n  }\n\n}\nLoader.CALLBACK_NAME = '_dk_google_maps_loader_cb';","map":{"version":3,"sources":["../../src/loader.ts"],"names":[],"mappings":"AAaA,OAAM,MAAO,MAAP,CAAa;AAYlB,EAAA,WAAA,CACS,MAAA,GAAiB,IAD1B,EAES,OAAA,GAAyB,EAFlC,EAEoC;AAD3B,SAAA,MAAA,GAAA,MAAA;AACA,SAAA,OAAA,GAAA,OAAA;;AAER,QAAI,OAAO,MAAP,KAAkB,WAAtB,EAAmC;AAClC,YAAM,IAAI,KAAJ,CAAU,sDAAV,CAAN;AACA;AACD;;AAEM,EAAA,IAAI,GAAA;AAEV,QAAI,OAAO,KAAK,GAAZ,KAAoB,WAAxB,EAAqC;AACpC,aAAO,OAAO,CAAC,OAAR,CAAgB,KAAK,GAArB,CAAP;AACA;;AAED,QAAI,OAAO,KAAK,MAAZ,KAAuB,WAA3B,EAAwC;AACvC,aAAO,KAAK,MAAZ;AACA;;AAED,IAAA,MAAM,CAAC,MAAM,CAAC,aAAR,CAAN,GAA+B,MAAK;AACnC,WAAK,GAAL,GAAW,MAAM,CAAC,QAAD,CAAjB;;AAEA,UAAI,OAAO,KAAK,OAAZ,KAAwB,WAA5B,EAAyC;AACxC,cAAM,IAAI,KAAJ,CAAU,mBAAV,CAAN;AACA;;AAED,WAAK,OAAL,CAAa,KAAK,GAAlB;AACA,KARD;;AAUA,IAAA,MAAM,CAAC,gBAAD,CAAN,GAA2B,MAAK;AAC/B,UAAI,OAAO,KAAK,MAAZ,KAAuB,WAA3B,EAAwC;AACvC,cAAM,IAAI,KAAJ,CAAU,mBAAV,CAAN;AACA;;AAED,WAAK,MAAL,CAAY,IAAI,KAAJ,CAAU,mCAAV,CAAZ;AACA,KAND;;AAQA,WAAO,KAAK,MAAL,GAAc,IAAI,OAAJ,CAAY,CAAC,OAAD,EAAU,MAAV,KAAoB;AACpD,WAAK,OAAL,GAAe,OAAf;AACA,WAAK,MAAL,GAAc,MAAd;AAEA,YAAM,MAAM,GAAG,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAf;AACA,MAAA,MAAM,CAAC,GAAP,GAAa,KAAK,SAAL,EAAb;AACA,MAAA,MAAM,CAAC,KAAP,GAAe,IAAf;;AACA,MAAA,MAAM,CAAC,OAAP,GAAkB,CAAD,IAAO,MAAM,CAAC,CAAD,CAA9B;;AAEA,MAAA,QAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,MAA1B;AACA,KAVoB,CAArB;AAWA;;AAEO,EAAA,SAAS,GAAA;AAEhB,UAAM,UAAU,GAAkB,CACjC,YAAY,MAAM,CAAC,aAAa,EADC,CAAlC;;AAIA,QAAG,KAAK,MAAR,EAAgB;AACf,MAAA,UAAU,CAAC,IAAX,CAAgB,OAAO,KAAK,MAAM,EAAlC;AACA;;AAED,SAAK,IAAI,IAAT,IAAiB,KAAK,OAAtB,EAA+B;AAC9B,UAAI,KAAK,OAAL,CAAa,cAAb,CAA4B,IAA5B,CAAJ,EAAuC;AACtC,YAAI,KAAK,GAAG,KAAK,OAAL,CAAa,IAAb,CAAZ;;AAEA,YAAI,IAAI,KAAK,SAAb,EAAwB;AACvB,UAAA,IAAI,GAAG,GAAP;AACA;;AAED,YAAI,IAAI,KAAK,WAAb,EAA0B;AACzB,UAAA,KAAK,GAAG,KAAK,CAAC,IAAN,CAAW,GAAX,CAAR;AACA;;AAED,QAAA,UAAU,CAAC,IAAX,CAAgB,GAAG,IAAI,IAAI,KAAK,EAAhC;AACA;AACD;;AAED,WAAO,2CAA2C,UAAU,CAAC,IAAX,CAAgB,GAAhB,CAAoB,EAAtE;AACA;;AAzFiB;AAEH,MAAA,CAAA,aAAA,GAAgB,2BAAhB","sourceRoot":"","sourcesContent":["export class Loader {\n    constructor(apiKey = null, options = {}) {\n        this.apiKey = apiKey;\n        this.options = options;\n        if (typeof window === 'undefined') {\n            throw new Error('google-maps is supported only in browser environment');\n        }\n    }\n    load() {\n        if (typeof this.api !== 'undefined') {\n            return Promise.resolve(this.api);\n        }\n        if (typeof this.loader !== 'undefined') {\n            return this.loader;\n        }\n        window[Loader.CALLBACK_NAME] = () => {\n            this.api = window['google'];\n            if (typeof this.resolve === 'undefined') {\n                throw new Error('Should not happen');\n            }\n            this.resolve(this.api);\n        };\n        window['gm_authFailure'] = () => {\n            if (typeof this.reject === 'undefined') {\n                throw new Error('Should not happen');\n            }\n            this.reject(new Error('google-maps: authentication error'));\n        };\n        return this.loader = new Promise((resolve, reject) => {\n            this.resolve = resolve;\n            this.reject = reject;\n            const script = document.createElement('script');\n            script.src = this.createUrl();\n            script.async = true;\n            script.onerror = (e) => reject(e);\n            document.head.appendChild(script);\n        });\n    }\n    createUrl() {\n        const parameters = [\n            `callback=${Loader.CALLBACK_NAME}`,\n        ];\n        if (this.apiKey) {\n            parameters.push(`key=${this.apiKey}`);\n        }\n        for (let name in this.options) {\n            if (this.options.hasOwnProperty(name)) {\n                let value = this.options[name];\n                if (name === 'version') {\n                    name = 'v';\n                }\n                if (name === 'libraries') {\n                    value = value.join(',');\n                }\n                parameters.push(`${name}=${value}`);\n            }\n        }\n        return `https://maps.googleapis.com/maps/api/js?${parameters.join('&')}`;\n    }\n}\nLoader.CALLBACK_NAME = '_dk_google_maps_loader_cb';\n//# sourceMappingURL=loader.js.map"]},"metadata":{},"sourceType":"module"}